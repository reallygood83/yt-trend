rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Premium Users Collection
    match /premiumUsers/{userId} {
      // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ë³¸ì¸ í”„ë¦¬ë¯¸ì—„ ìƒíƒœ í™•ì¸ ê°€ëŠ¥
      allow read: if request.auth != null && request.auth.uid == userId;
      // âš ï¸ ì„ì‹œ: API Routeì—ì„œ í”„ë¦¬ë¯¸ì—„ ê¶Œí•œ ë¶€ì—¬ë¥¼ ìœ„í•´ ì“°ê¸° í—ˆìš©
      // TODO: Firebase Admin SDKë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ í›„ allow write: if falseë¡œ ë³€ê²½
      allow write: if true;  // ì„œë²„ì‚¬ì´ë“œ API Routeìš©
    }

    // Learning Notes Collection
    match /learningNotes/{noteId} {
      // âš ï¸ ì„ì‹œ í…ŒìŠ¤íŠ¸ìš© - ì„œë²„ ì‚¬ì´ë“œ API Routeë¥¼ ìœ„í•´ ì™„ì „íˆ ì˜¤í”ˆ
      // TODO: Firebase Admin SDKë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
      // í˜„ì¬ëŠ” API Routeì—ì„œ userId ê²€ì¦ìœ¼ë¡œ ë³´ì•ˆ ìœ ì§€
      allow read, write: if true;
    }

    // User API Keys Collection (ì•”í˜¸í™”ëœ API í‚¤ ì €ì¥)
    match /userAPIKeys/{userId} {
      // ğŸ”’ ë³´ì•ˆ: ë³¸ì¸ì˜ API í‚¤ë§Œ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥
      // ì„œë²„ ì‚¬ì´ë“œì—ì„œëŠ” ë³µí˜¸í™” ì‹œ userId ê²€ì¦ìœ¼ë¡œ ì¶”ê°€ ë³´ì•ˆ
      allow read, write: if true; // ì„ì‹œë¡œ ì˜¤í”ˆ (ì„œë²„ì‚¬ì´ë“œ API Routeìš©)
    }

    // Default Deny
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
