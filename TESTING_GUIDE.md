# π§ λ…ΈνΈ μ €μ¥/κ³µμ /ν”„λ¦¬λ―Έμ—„ μ‹μ¤ν… ν…μ¤νΈ κ°€μ΄λ“

## π“‹ λ©μ°¨
1. [λ°°ν¬ μ „ μ¤€λΉ„μ‚¬ν•­](#λ°°ν¬-μ „-μ¤€λΉ„μ‚¬ν•­)
2. [μΌλ° μ‚¬μ©μ ν…μ¤νΈ](#μΌλ°-μ‚¬μ©μ-ν…μ¤νΈ)
3. [ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ ν…μ¤νΈ](#ν”„λ¦¬λ―Έμ—„-μ‚¬μ©μ-ν…μ¤νΈ)
4. [κ³µμ  κΈ°λ¥ ν…μ¤νΈ](#κ³µμ -κΈ°λ¥-ν…μ¤νΈ)
5. [λ²„κ·Έ μμ • ν™•μΈ](#λ²„κ·Έ-μμ •-ν™•μΈ)

---

## λ°°ν¬ μ „ μ¤€λΉ„μ‚¬ν•­

### 1οΈβƒ£ Firebase κ·μΉ™ λ°°ν¬ (ν•„μ!)
```bash
# Firebase CLIλ΅ λ΅κ·ΈμΈ
firebase login

# Firestore κ·μΉ™ λ°°ν¬
firebase deploy --only firestore:rules
```

**ν™•μΈ λ°©λ²•**:
- Firebase Console β†’ Firestore Database β†’ Rules νƒ­
- `premiumUsers` μ»¬λ ‰μ… κ·μΉ™ ν™•μΈ
- `learningNotes` μ»¬λ ‰μ…μ `shareId` μ΅°ν κ·μΉ™ ν™•μΈ

### 2οΈβƒ£ Vercel μ¬λ°°ν¬
```bash
# Git μ»¤λ°‹ λ° ν‘Έμ‹
git add .
git commit -m "feat: Add note save/share/premium system"
git push origin main
```

Vercelμ€ μλ™μΌλ΅ λ°°ν¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

### 3οΈβƒ£ ν™κ²½ λ³€μ ν™•μΈ
Vercel Dashboard β†’ Settings β†’ Environment Variables
- `NEXT_PUBLIC_FIREBASE_*` λ¨λ“  λ³€μ ν™•μΈ
- Production ν™κ²½μ— μ μ©λμ—λ”μ§€ ν™•μΈ

---

## μΌλ° μ‚¬μ©μ ν…μ¤νΈ

### π“ μ‹λ‚λ¦¬μ¤ 1: λ…ΈνΈ 3κ° μƒμ„± λ° μ ν• ν™•μΈ

#### Step 1: μ²« λ²μ§Έ λ…ΈνΈ μƒμ„±
1. `/note` νμ΄μ§€ μ ‘μ†
2. YouTube URL μ…λ ¥: https://www.youtube.com/watch?v=dQw4w9WgXcQ
3. μ—°λ Ήλ€ μ„ νƒ: μ¤‘ν•™μƒ
4. μ„¤λ… λ°©λ²• μ„ νƒ: κ°λ… μ •λ¦¬
5. "ν•™μµ λ…ΈνΈ μƒμ„±ν•κΈ°" ν΄λ¦­
6. μƒμ„± μ™„λ£ ν›„ "λ…ΈνΈ μ €μ¥ν•κΈ°" λ²„νΌ ν΄λ¦­

**β… κΈ°λ€ κ²°κ³Ό**:
```
μ•λ¦Όμ°½: "β… λ…ΈνΈκ°€ μ„±κ³µμ μΌλ΅ μ €μ¥λμ—μµλ‹λ‹¤! μ•„λμ—μ„ κ³µμ  λ§ν¬λ¥Ό ν™•μΈν•μ„Έμ”."
```
- κ³µμ  λ§ν¬ ν‘μ‹λ¨
- λ§ν¬ λ³µμ‚¬ λ²„νΌ μ‘λ™ ν™•μΈ

#### Step 2: λ‘ λ²μ§Έ, μ„Έ λ²μ§Έ λ…ΈνΈ μƒμ„±
1. Step 1 λ°λ³µ (λ‹¤λ¥Έ YouTube λ§ν¬ μ‚¬μ©)
2. κ° λ…ΈνΈλ§λ‹¤ κ³µμ  λ§ν¬ μƒμ„± ν™•μΈ

**β… κΈ°λ€ κ²°κ³Ό**:
- 3κ° λ…ΈνΈ λ¨λ‘ μ €μ¥ μ„±κ³µ
- `/notes` νμ΄μ§€μ—μ„ "μ €μ¥λ λ…ΈνΈ 3/3κ°" ν‘μ‹

#### Step 3: 4λ²μ§Έ λ…ΈνΈ μƒμ„± μ‹λ„ (μ ν• ν™•μΈ)
1. `/note` νμ΄μ§€μ—μ„ μƒ λ…ΈνΈ μƒμ„±
2. "λ…ΈνΈ μ €μ¥ν•κΈ°" ν΄λ¦­

**β… κΈ°λ€ κ²°κ³Ό**:
```json
{
  "success": false,
  "error": "μµλ€ 3κ°μ λ…ΈνΈλ§ μ €μ¥ν•  μ μμµλ‹λ‹¤. κΈ°μ΅΄ λ…ΈνΈλ¥Ό μ‚­μ ν•΄μ£Όμ„Έμ”.",
  "requiresDeletion": true,
  "existingNotes": [...]
}
```
- μ‚­μ  λ¨λ‹¬ ν‘μ‹
- κΈ°μ΅΄ λ…ΈνΈ λ©λ΅ ν‘μ‹
- λ…ΈνΈ μ„ νƒ ν›„ μ‚­μ  κ°€λ¥

#### Step 4: λ…ΈνΈ μ‚­μ  ν›„ μ¬μ €μ¥
1. μ‚­μ  λ¨λ‹¬μ—μ„ λ…ΈνΈ 1κ° μ‚­μ 
2. λ‹¤μ‹ "λ…ΈνΈ μ €μ¥ν•κΈ°" ν΄λ¦­

**β… κΈ°λ€ κ²°κ³Ό**:
- μ‚­μ  μ„±κ³µ
- μƒ λ…ΈνΈ μ €μ¥ μ„±κ³µ
- `/notes`μ—μ„ 3/3κ° μ μ§€

---

## ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ ν…μ¤νΈ

### π“ μ‹λ‚λ¦¬μ¤ 2: ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ λ“±λ΅ λ° λ¬΄μ ν• μ €μ¥

#### Step 1: Firebase Consoleμ—μ„ ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ μ¶”κ°€

1. **Firebase Console μ ‘μ†**
   - https://console.firebase.google.com
   - ν”„λ΅μ νΈ μ„ νƒ

2. **Authenticationμ—μ„ μ‚¬μ©μ UID λ³µμ‚¬**
   - Authentication β†’ Users
   - ν…μ¤νΈν•  μ‚¬μ©μμ UID λ³µμ‚¬

3. **Firestoreμ—μ„ premiumUsers μ»¬λ ‰μ… μƒμ„±**
   - Firestore Database β†’ λ°μ΄ν„° νƒ­
   - "μ»¬λ ‰μ… μ‹μ‘" ν΄λ¦­
   - μ»¬λ ‰μ… ID: `premiumUsers`

4. **ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ λ¬Έμ„ μ¶”κ°€**
   - λ¬Έμ„ ID: `[λ³µμ‚¬ν• μ‚¬μ©μ UID]`
   - ν•„λ“ μ¶”κ°€:
     - `isPremium` (boolean): `true`
     - `grantedAt` (timestamp): μλ™
     - `grantedBy` (string): `admin`
     - `email` (string): μ‚¬μ©μ μ΄λ©”μΌ
   - "μ €μ¥" ν΄λ¦­

#### Step 2: ν”„λ¦¬λ―Έμ—„ μƒνƒ ν™•μΈ
1. `/notes` νμ΄μ§€ μƒλ΅κ³ μΉ¨

**β… κΈ°λ€ κ²°κ³Ό**:
```
μ λ© μ†μ— "β¨ ν”„λ¦¬λ―Έμ—„" λ°°μ§€ ν‘μ‹
μ €μ¥λ λ…ΈνΈ μ λ€μ‹  "λ¬΄μ ν• λ…ΈνΈ μ €μ¥ κ°€λ¥ β¨" ν‘μ‹
```

#### Step 3: 4κ° μ΄μƒ λ…ΈνΈ μƒμ„±
1. `/note` νμ΄μ§€μ—μ„ λ…ΈνΈ 4κ° μ—°μ† μƒμ„±
2. κ° λ…ΈνΈλ§λ‹¤ "λ…ΈνΈ μ €μ¥ν•κΈ°" ν΄λ¦­

**β… κΈ°λ€ κ²°κ³Ό**:
```
λ¨λ“  λ…ΈνΈ μ €μ¥ μ„±κ³µ
μ•λ¦Όμ°½: "β¨ ν”„λ¦¬λ―Έμ—„ λ…ΈνΈκ°€ μ„±κ³µμ μΌλ΅ μ €μ¥λμ—μµλ‹λ‹¤! λ¬΄μ ν•μΌλ΅ λ…ΈνΈλ¥Ό μƒμ„±ν•μ‹¤ μ μμµλ‹λ‹¤."
3κ° μ ν• μ—†μ΄ κ³„μ† μ €μ¥ κ°€λ¥
```

#### Step 4: ν”„λ¦¬λ―Έμ—„ API μ§μ ‘ ν™•μΈ
λΈλΌμ°μ € μ½μ†”μ—μ„ μ‹¤ν–‰:
```javascript
fetch('/api/user/check-premium?userId=YOUR_USER_ID')
  .then(res => res.json())
  .then(data => console.log(data));
```

**β… κΈ°λ€ κ²°κ³Ό**:
```json
{
  "isPremium": true,
  "message": "ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μμ…λ‹λ‹¤. λ¬΄μ ν• λ…ΈνΈλ¥Ό μ €μ¥ν•  μ μμµλ‹λ‹¤.",
  "details": {
    "grantedAt": "2025-01-24T...",
    "grantedBy": "admin",
    "email": "user@example.com"
  }
}
```

---

## κ³µμ  κΈ°λ¥ ν…μ¤νΈ

### π“ μ‹λ‚λ¦¬μ¤ 3: λ…ΈνΈ κ³µμ  λ° λΉ„λ΅κ·ΈμΈ μ ‘κ·Ό

#### Step 1: λ…ΈνΈ μ €μ¥ ν›„ κ³µμ  λ§ν¬ λ³µμ‚¬
1. λ…ΈνΈ μƒμ„± λ° μ €μ¥
2. κ³µμ  λ§ν¬ μΉ΄λ“μ—μ„ "λ³µμ‚¬" λ²„νΌ ν΄λ¦­

**β… κΈ°λ€ κ²°κ³Ό**:
```
μ•λ¦Όμ°½: "β… λ§ν¬κ°€ ν΄λ¦½λ³΄λ“μ— λ³µμ‚¬λμ—μµλ‹λ‹¤!"
ν΄λ¦½λ³΄λ“μ— λ§ν¬ μ €μ¥λ¨: https://your-domain.vercel.app/notes/share/ABC12345
```

#### Step 2: λΉ„λ΅κ·ΈμΈ μƒνƒμ—μ„ κ³µμ  λ§ν¬ μ ‘κ·Ό
1. **μ‹ν¬λ¦Ώ λ¨λ“** λλ” **λ‹¤λ¥Έ λΈλΌμ°μ €** μ—΄κΈ°
2. λ³µμ‚¬ν• κ³µμ  λ§ν¬ μ ‘μ†

**β… κΈ°λ€ κ²°κ³Ό**:
- λ΅κ·ΈμΈ μ—†μ΄ λ…ΈνΈ μ „μ²΄ λ‚΄μ© μ΅°ν κ°€λ¥
- YouTube μμƒ μ„λ² λ“ μ‘λ™
- νƒ€μ„μ¤νƒ¬ν”„λ³„ κµ¬κ°„ μμƒ μ¬μƒ κ°€λ¥
- κ³µμ  λ§ν¬ λ³µμ‚¬ λ²„νΌ μ‘λ™

#### Step 3: Firebase κ·μΉ™ ν™•μΈ
λΉ„λ΅κ·ΈμΈ μƒνƒμ—μ„λ„ μ ‘κ·Όμ΄ κ°€λ¥ν• μ΄μ :
```javascript
// firestore.rules
allow get: if resource.data.shareId != null;  // β… κ³µκ° κ³µμ 
```

#### Step 4: μλ»λ shareId μ ‘κ·Ό
1. μ΅΄μ¬ν•μ§€ μ•λ” shareId μ ‘κ·Ό: `/notes/share/INVALID123`

**β… κΈ°λ€ κ²°κ³Ό**:
```
μƒνƒ μ½”λ“: 404
λ©”μ‹μ§€: "κ³µμ λ λ…ΈνΈλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤."
```

---

## λ²„κ·Έ μμ • ν™•μΈ

### π“ μ‹λ‚λ¦¬μ¤ 4: API λ©”μ„λ“ λ¶μΌμΉ λ²„κ·Έ μμ • ν™•μΈ

#### μ΄μ „ λ²„κ·Έ:
- `/api/notes/list`κ°€ GET λ©”μ„λ“λ§ μ§€μ›
- ν”„λ΅ νΈμ—”λ“λ” POST μ”μ²­ β†’ JSON νμ‹± μ—λ¬

#### μμ • ν›„ ν…μ¤νΈ:
1. `/notes` νμ΄μ§€ μ ‘μ†
2. λΈλΌμ°μ € κ°λ°μ λ„κµ¬ β†’ Network νƒ­ ν™•μΈ
3. `notes/list` μ”μ²­ ν™•μΈ

**β… κΈ°λ€ κ²°κ³Ό**:
- μ”μ²­ λ©”μ„λ“: `POST`
- μ‘λ‹µ μƒνƒ: `200 OK`
- μ‘λ‹µ λ³Έλ¬Έ:
```json
{
  "success": true,
  "notes": [...],
  "count": 3
}
```
- **μ—λ¬ μ—†μ**: "Failed to execute 'json' on 'Response'" μ—λ¬ μ‚¬λΌμ§

### π“ μ‹λ‚λ¦¬μ¤ 5: Firebase κ·μΉ™ μ €μ¥ μ‹¤ν¨ λ²„κ·Έ μμ • ν™•μΈ

#### μ΄μ „ λ²„κ·Έ:
- λ…ΈνΈ μƒμ„± μ‹λ„ μ‹ Firebase κ·μΉ™μΌλ΅ μΈν• μ €μ¥ μ‹¤ν¨
- κ³µμ  λ…ΈνΈ μ΅°ν λ¶κ°€

#### μμ • ν›„ ν…μ¤νΈ:
1. λ…ΈνΈ μƒμ„± λ° μ €μ¥
2. Firebase Console β†’ Firestore β†’ learningNotes μ»¬λ ‰μ… ν™•μΈ

**β… κΈ°λ€ κ²°κ³Ό**:
- λ…ΈνΈ λ¬Έμ„ μ •μƒ μƒμ„±
- ν•„μ ν•„λ“ λ¨λ‘ μ΅΄μ¬:
  - `userId`
  - `noteData`
  - `metadata`
  - `createdAt`
  - `shareId`

---

## π― μΆ…ν•© μ²΄ν¬λ¦¬μ¤νΈ

### Phase 1: κΈ΄κΈ‰ μμ • (Immediate)
- [x] API λ©”μ„λ“ λ¶μΌμΉ μμ • (POST ν•Έλ“¤λ¬ μ¶”κ°€)
- [x] Firebase λ³΄μ• κ·μΉ™ μƒμ„± λ° λ°°ν¬
- [x] κ³µμ  λ…ΈνΈ λΉ„λ΅κ·ΈμΈ μ ‘κ·Ό κ·μΉ™ μ¶”κ°€

### Phase 2: ν”„λ¦¬λ―Έμ—„ μ‹μ¤ν… (High Priority)
- [x] ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ ν™•μΈ API (`/api/user/check-premium`)
- [x] μ €μ¥ APIμ— ν”„λ¦¬λ―Έμ—„ μ²΄ν¬ λ΅μ§ μ¶”κ°€
- [x] premiumUsers μ»¬λ ‰μ… μƒμ„± κ°€μ΄λ“
- [x] ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ UI λ°°μ§€

### Phase 3: UX κ°μ„  (Medium Priority)
- [x] κ³µμ  λ§ν¬ UI κ°μ„  (λ…ΈνΈ μƒμ„± νμ΄μ§€)
- [x] ν”„λ¦¬λ―Έμ—„ λ°°μ§€ (λ…ΈνΈ λ©λ΅ νμ΄μ§€)
- [x] μ €μ¥ μ„±κ³µ λ©”μ‹μ§€ κ°μ„  (ν”„λ¦¬λ―Έμ—„ κµ¬λ¶„)
- [x] λ‚΄ λ…ΈνΈ κ΄€λ¦¬ λ§ν¬ μ¶”κ°€

### Phase 4: λ¬Έμ„ν™” (Documentation)
- [x] SPEC λ¬Έμ„ μ‘μ„± (`SPEC_NOTE_SAVE_SHARE.md`)
- [x] ν„μ¬ μƒνƒ λ¶„μ„ (`CURRENT_STATE_ANALYSIS.md`)
- [x] Firebase λ°°ν¬ κ°€μ΄λ“ (`FIREBASE_DEPLOYMENT_GUIDE.md`)
- [x] ν…μ¤νΈ κ°€μ΄λ“ (`TESTING_GUIDE.md`)

---

## π¨ λ¬Έμ  ν•΄κ²° (Troubleshooting)

### λ¬Έμ  1: Firebase κ·μΉ™ λ°°ν¬ μ‹¤ν¨
```
Error: Permission denied
```
**ν•΄κ²° λ°©λ²•**:
```bash
firebase login --reauth
firebase use --add  # ν”„λ΅μ νΈ μ„ νƒ
firebase deploy --only firestore:rules
```

### λ¬Έμ  2: ν”„λ¦¬λ―Έμ—„ μƒνƒκ°€ λ°μ μ•λ¨
**ν™•μΈ μ‚¬ν•­**:
1. Firebase Consoleμ—μ„ `premiumUsers` μ»¬λ ‰μ… μ΅΄μ¬ ν™•μΈ
2. λ¬Έμ„ IDκ°€ μ‚¬μ©μ UIDμ™€ μ •ν™•ν μΌμΉν•λ”μ§€ ν™•μΈ
3. `isPremium` ν•„λ“κ°€ `boolean` νƒ€μ… `true`μΈμ§€ ν™•μΈ
4. λΈλΌμ°μ € μΊμ‹ μ‚­μ  ν›„ μ¬μ‹λ„

### λ¬Έμ  3: κ³µμ  λ§ν¬ 404 μ—λ¬
**ν™•μΈ μ‚¬ν•­**:
1. Firebase κ·μΉ™μ΄ λ°°ν¬λμ—λ”μ§€ ν™•μΈ
2. `shareId`κ°€ λ…ΈνΈ λ¬Έμ„μ— μ¬λ°”λ¥΄κ² μ €μ¥λμ—λ”μ§€ ν™•μΈ
3. URL ν•μ‹: `/notes/share/[shareId]` (8μλ¦¬ λλ¤ λ¬Έμμ—΄)

### λ¬Έμ  4: API νΈμ¶ μ—λ¬
**ν™•μΈ μ‚¬ν•­**:
```javascript
// λΈλΌμ°μ € μ½μ†”μ—μ„ Firebase μ΄κΈ°ν™” ν™•μΈ
console.log('Firebase initialized:', !!db);

// API ν…μ¤νΈ
fetch('/api/notes/list', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ userId: 'YOUR_USER_ID' })
})
.then(res => res.json())
.then(data => console.log(data));
```

---

## π“ μ„±κ³µ κΈ°μ¤€

### μΌλ° μ‚¬μ©μ (Free Tier)
- β… μµλ€ 3κ° λ…ΈνΈ μ €μ¥ κ°€λ¥
- β… 4λ²μ§Έ λ…ΈνΈ μ‹λ„ μ‹ μ‚­μ  λ¨λ‹¬ ν‘μ‹
- β… κ³µμ  λ§ν¬ μƒμ„± λ° λ³µμ‚¬ κ°€λ¥
- β… λΉ„λ΅κ·ΈμΈ μ‚¬μ©μλ„ κ³µμ  λ§ν¬ μ΅°ν κ°€λ¥

### ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ
- β… λ¬΄μ ν• λ…ΈνΈ μ €μ¥ κ°€λ¥
- β… ν”„λ¦¬λ―Έμ—„ λ°°μ§€ UI ν‘μ‹
- β… ν”„λ¦¬λ―Έμ—„ μ „μ© μ €μ¥ μ„±κ³µ λ©”μ‹μ§€
- β… Firebase Consoleμ—μ„ κ¶ν• κ΄€λ¦¬ κ°€λ¥

### μ‹μ¤ν… μ•μ •μ„±
- β… Firebase λ³΄μ• κ·μΉ™ μ μ©
- β… λ¨λ“  API μ •μƒ μ‘λ™ (GET/POST)
- β… TypeScript νƒ€μ… μ—λ¬ μ—†μ
- β… Vercel λΉλ“ μ„±κ³µ

---

## π‰ λ°°ν¬ μ™„λ£ ν›„ μµμΆ… ν™•μΈ

1. **Production ν™κ²½ ν…μ¤νΈ**
   - Vercel λ°°ν¬λ URLμ—μ„ λ¨λ“  μ‹λ‚λ¦¬μ¤ μ¬ν…μ¤νΈ

2. **Firebase Console ν™•μΈ**
   - learningNotes μ»¬λ ‰μ…μ— λ¬Έμ„ μƒμ„± ν™•μΈ
   - premiumUsers μ»¬λ ‰μ… μ΅΄μ¬ ν™•μΈ
   - Rules νƒ­μ—μ„ κ·μΉ™ λ°°ν¬ ν™•μΈ

3. **μ‚¬μ©μ κ²½ν— ν™•μΈ**
   - λ¨λ°”μΌ λΈλΌμ°μ €μ—μ„ ν…μ¤νΈ
   - λ‹¤μ–‘ν• λΈλΌμ°μ €(Chrome, Safari, Firefox)μ—μ„ ν…μ¤νΈ
   - κ³µμ  λ§ν¬λ¥Ό μΉκµ¬μ—κ² μ „μ†΅ν•μ—¬ μ‹¤μ  κ³µμ  ν…μ¤νΈ

---

## π“ λ¬Έμ λ° ν”Όλ“λ°±

λ¬Έμ κ°€ λ°μƒν•λ©΄:
1. λΈλΌμ°μ € κ°λ°μ λ„κµ¬ μ½μ†” ν™•μΈ
2. Firebase Console β†’ Firestore β†’ Rules νƒ­ ν™•μΈ
3. Vercel Dashboard β†’ Deployments β†’ Logs ν™•μΈ
4. GitHub Issuesμ— μ—λ¬ λ΅κ·Έμ™€ ν•¨κ» λ³΄κ³ 

**ν…μ¤νΈ μ™„λ£ ν›„ λ¨λ“  κΈ°λ¥μ΄ μ •μƒ μ‘λ™ν•λ©΄ π‰ μ¶•ν•ν•©λ‹λ‹¤!**
